<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Description &mdash; mpieva/quicksand v1.5 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/style.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Installation" href="installation.html" />
    <link rel="prev" title="Quickstart" href="quickstart.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> mpieva/quicksand
          </a>
              <div class="version">
                v1.5
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quickstart</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Description</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#workflow">Workflow</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#assignment">Assignment</a></li>
<li class="toctree-l3"><a class="reference internal" href="#mapping">Mapping</a></li>
<li class="toctree-l3"><a class="reference internal" href="#analysis">Analysis</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="usage.html">Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="configuration.html">Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="quicksand-build.html">quicksand-build</a></li>
<li class="toctree-l1"><a class="reference internal" href="contribute.html">Contribute</a></li>
<li class="toctree-l1"><a class="reference internal" href="license.html">License</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">mpieva/quicksand</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Description</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/description.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="description">
<h1>Description<a class="headerlink" href="#description" title="Permalink to this headline"></a></h1>
<a class="reference internal image-reference" href="_images/pipeline_overview.png"><img alt="Graphical overview over the processes of the quicksand pipeline" src="_images/pipeline_overview.png" style="width: 800px;" /></a>
<section id="workflow">
<h2>Workflow<a class="headerlink" href="#workflow" title="Permalink to this headline"></a></h2>
<p>The pipeline consists of three main parts - <strong>Classification</strong> of reads, <strong>Mapping</strong> of reads to reference genomes and a <strong>Report/Analysis</strong> for the created alignments. The pipeline starts with sequenced and demultiplexed, adapter-clipped, and overlap-merged paired reads from an Illumina Hiseq or Miseq platform in either fastq- or bam-format. Classification of reads by KrakenUniq is followed by a mapping step with <span id="id1">[BWA]</span> and an analysis of the alignments for quality and aDNA damage patterns. We provide both a taxonomic profile as well as a taxonomic binning of reads by readgroups on a family level.</p>
<p>In the final report we additionally provide the proportion of assigned families as well as an estimate of the ‘ancientness’ of the reads. See the Figure for an overview.</p>
<section id="assignment">
<h3>Assignment<a class="headerlink" href="#assignment" title="Permalink to this headline"></a></h3>
<p>Quicksand uses KrakenUniq with a precompiled database created from the current (see <a class="reference internal" href="installation.html#setup"><span class="std std-ref">04. Setup Datastructure</span></a>) non-redundant mammalian mtDNA RefSeq database <span id="id2">[Refseq]</span> and by default a k-mer size of 22. The speed of KrakenUniq allows for a quick sorting of reads into families. To filter for false-positive assignments, we disregard families that are assigned by less than 3 reads or 129 unique k-mers. For each family the taxon with the highest number of assigned unique k-mers is picked as the taxon representative for that family at that site. In parallel, all reads assigned to that family are binned and extracted from the original input-file.</p>
</section>
<section id="mapping">
<h3>Mapping<a class="headerlink" href="#mapping" title="Permalink to this headline"></a></h3>
<p>The extracted reads - based on the KrakenUniq assignments - are then mapped against all reference genomes of species from the representative taxon using the  <a class="reference external" href="https://github.com/mpieva/network-aware-bwa">network-aware fork</a> of BWA with ancient parameters [Meyer,2012]_. Exact PCR-duplicates are collapsed into singletons using <a class="reference external" href="https://github.com/mpieva/biohazard-tools">bam-rmdup</a> based on the sharing of identical alignment start and end coordinates. Reads shorter than 35bp and reads with a mapping quality of less than 25 are removed. From all mapped genomes, the one with the highest numbers of basepairs covered is picked as the final representative for the mapping analysis. To avoid the mapping of sequences to non-informative and repetitive regions, the alignments are depleted of reads that overlap sites marked as non-informative by [dustmasker].</p>
</section>
<section id="analysis">
<h3>Analysis<a class="headerlink" href="#analysis" title="Permalink to this headline"></a></h3>
<p>Based on the mappings to the reference genome a rough estimate of the ancientness of the mapped reads is reported. Reads generated from ancient DNA show characteristic C to T substitutions at the 3’ and 5’ ends of the fragment - a typical degradation pattern used to identify ancient DNA in silico. Families that have more than 10% of both terminal positions - with a C in the reference genome - replaced with a T are reported as being ancient in the summary report.</p>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="quickstart.html" class="btn btn-neutral float-left" title="Quickstart" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="installation.html" class="btn btn-neutral float-right" title="Installation" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, Merlin Szymanski.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>