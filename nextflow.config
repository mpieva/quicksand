manifest {
    homePage = 'https://vcs.eva.mpg.de/visagie/sediment_nf'
    description = 'An ancient DNA Sediment pipeline'
    nextflowVersion = '>=20.04'
    version = '1.0'
}

trace {
    enabled = true
    file = 'reports/trace.tsv'
}

timeline {
    enabled = true
    file = 'reports/timeline.html'
}

report {
    enabled = true
    file = 'reports/report.html'
}

executor {
    name = 'sge'
    queueSize = 250
    pollInterval = '30 sec'
}

profiles {
    standard {
        process {
            conda = "$baseDir/envs/sediment.yaml"
            executor = 'local'
            errorStrategy = 'retry'
            maxRetries = 5
        }
    }

    docker {
        docker.enabled = true
        process {
            container = 'merszym/sediment_nf:0.9.3.3'
            errorStrategy = 'retry'
            executor = 'local'
            maxRetries = 5
        }
        params{
            bwa      = 'bwa'
            bamrmdup = 'bam-rmdup'
            kraken_uniq = 'krakenuniq'
        }
    }
    singularity {
        singularity.enabled = true
        singularity.autoMounts = true
        process {
            container = 'merszym/sediment_nf:0.9.3.3'
            errorStrategy = 'retry'
            executor = 'local'
            maxRetries = 5
        }
        params{
            bwa      = 'bwa'
            bamrmdup = 'bam-rmdup'
            kraken_uniq = 'krakenuniq'
        }
    }
    
    cluster {
        process {
            conda = "$baseDir/envs/sediment.yaml"
            withLabel: '!local' {
                executor = 'sge'
                penv = 'smp'
                queue = 'all.q'
                clusterOptions = '-m n'
                errorStrategy = 'retry'
                maxRetries = 5
            }
            withLabel: local {
                executor = 'local'
                errorStrategy = 'retry'
                maxRetries = 5
            }
        }
    }
}
